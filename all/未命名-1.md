```mermaid
graph TD
    A[Input: (B, 1, C, T)] --> B[Squeeze(1): (B, C, T)]
    B --> C[Permute: (B, T, C)]
    C --> D[TimesBlock]
    D --> E[Permute: (B, C, T)]
    E --> F[Unsqueeze(1): (B, 1, C, T)]
    F --> G[Conv2D: kernel=(1, T), F1=64]
    G --> H[BatchNorm2D]
    H --> I[Depthwise Conv2D: (C,1), Groups=F1]
    I --> J[BatchNorm2D]
    J --> K[ELU + AvgPool(1,4) + Dropout]
    K --> L[DepthwiseConv2D: kernel=(1, T/16)]
    L --> M[PointwiseConv2D: F2=64]
    M --> N[BatchNorm2D]
    N --> O[ELU + AvgPool(1,8) + Dropout]
    O --> P[AdaptiveAvgPool2D: (1,1)]
    P --> Q[Flatten]
    Q --> R[Linear: num_classes]
    R --> S[Softmax Output]

    subgraph TimesBlock
        D --> D1[FFT_for_Period]
        D1 --> D2[Extract Top-k Periods]
        D2 --> D3[Loop for k periods]
        D3 --> D4[Padding if needed]
        D4 --> D5[Reshape to 2D]
        D5 --> D6[Inception_Block_V1 x2]
        D6 --> D7[Reshape back]
        D7 --> D8[Stack Results]
        D8 --> D9[Adaptive Aggregation]
        D9 --> D10[Residual Connection]
    end

    %% TimesBlock 内部细节
    D1 -->|输入| X[B, T, C]
    D1 -->|步骤1| FFT[FFT计算频谱]
    FFT -->|步骤2| Amp[计算振幅均值]
    Amp -->|步骤3| TopK[选择top-k周期]
    D3 -->|每个周期i| Loop[Period i]
    Loop -->|检查长度| CheckLength{是否整除?}
    CheckLength -->|是| NoPad[直接使用]
    CheckLength -->|否| Pad[补零填充]
    Pad --> Reshape2D[Reshape: B, C, T/period, period]
    Reshape2D --> Inception[Inception块处理]
    Inception --> ReshapeBack[Reshape回原维度]
    ReshapeBack --> Save[保存结果]
    D8 --> Stack[堆叠k个结果]
    Stack --> Weight[Softmax权重聚合]
    Weight --> Add[残差连接]
```