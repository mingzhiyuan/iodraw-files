```mermaid
graph TD
    %% 全局样式定义
    classDef startend fill:#F5EBFF,stroke:#BE8FED,stroke-width:2px
    classDef process fill:#E5F6FF,stroke:#73A6FF,stroke-width:2px
    classDef subgraph-bg fill:#F8F8F8,stroke:#DDD,stroke-width:1px
    
    %% 主流程开始
    A([输入]):::startend --> B["数据形状: (B, 1, C, T)"]:::process
    B --> C["维度调整: squeeze(1) → (B, C, T)"]:::process
    C --> D["维度交换: permute(0,2,1) → (B, T, C)"]:::process
    D --> E[TimesBlock 模块]:::process
    
    %% %% TimesBlock 子图
    %% subgraph TimesBlock
    %%     direction LR
    %%     class TimesBlock subgraph-bg
    %%     E1[FFT_for_Period]:::process --> E2[获取前k个周期]:::process
    %%     E2 --> F1[循环k次周期处理]:::process
    %%     F1 --> F2{"是否需要填充?"}:::process
    %%     F2 -->|是| F3[填充至周期整数倍]:::process
    %%     F2 -->|否| F4[直接使用原长度]:::process
    %%     F3 & F4 --> F5["维度重塑: (B, T, C) → (B, G, P, C)"]:::process
    %%     F5 --> F6[2D卷积模块 (Inception Block)]:::process
    %%     F6 --> F7["维度恢复: (B, G, P, C) → (B, T', C)"]:::process
    %%     F7 --> F8[结果堆叠]:::process
    %%     F8 --> F9[加权聚合 (Softmax权重)]:::process
    %%     F9 --> F10[残差连接: + 输入]:::process
    %% end
    
    %% E --> F10
    %% F10 --> G["维度交换: permute(0,2,1) → (B, C, T)"]:::process
    %% G --> H["添加通道维度: unsqueeze(1) → (B, 1, C, T)"]:::process
    
    %% %% 第一层：时间卷积 + 空间卷积
    %% H --> I[Conv1: 时间卷积 (1, T)]:::process
    %% I --> J[BN1_1: 批归一化]:::process
    %% J --> K[DepthwiseConv: 空间卷积 (C,1)]:::process
    %% K --> L[BN1_2: 批归一化]:::process
    %% L --> M[激活函数: ELU]:::process
    %% M --> N[Pool1: 平均池化 (1,4)]:::process
    %% N --> O[Dropout: p=0.5]:::process
    
    %% %% 第二层：深度可分离卷积
    %% O --> P[DepthwiseConv2: 深度卷积 (1, T/16)]:::process
    %% P --> Q[PointwiseConv2: 逐点卷积 (1,1)]:::process
    %% Q --> R[BN2: 批归一化]:::process
    %% R --> S[激活函数: ELU]:::process
    %% S --> T[Pool2: 平均池化 (1,8)]:::process
    %% T --> U[Dropout: p=0.5]:::process
    
    %% %% 第三层：全局池化 + 全连接
    %% U --> V[GlobalPool: 自适应平均池化]:::process
    %% V --> W["维度调整: view(-1, F2)"]:::process
    %% W --> X[FC层: 全连接至类别数]:::process
    %% X --> Y([输出 logits]):::startend
    
    %% %% 流程连线优化
    %% F10 --> G
    %% G --> H
    %% H --> I
    %% I --> J
    %% J --> K
    %% K --> L
    %% L --> M
    %% M --> N
    %% N --> O
    %% O --> P
    %% P --> Q
    %% Q --> R
    %% R --> S
    %% S --> T
    %% T --> U
    %% U --> V
    %% V --> W
    %% W --> X
    %% X --> Y
```